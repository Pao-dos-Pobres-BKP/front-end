server {
  listen 80;
  server_name _;

  # Redirect /fe -> /fe/
  location = /fe {
    return 302 /fe/;
  }

  # Cache static assets aggressively (e.g., /fe/assets/*.js, .css, images, fonts)
  location ~* ^/fe/(.+\.(?:js|css|png|jpe?g|gif|svg|ico|woff2?|woff|ttf|map))$ {
    alias /usr/share/nginx/html/$1;
    access_log off;
    expires 1y;
    add_header Cache-Control "public, immutable";
  }

  # Main SPA handler: everything under /fe/* falls back to index.html
  location ^~ /fe/ {
    # IMPORTANT:
    # Use alias because your app is built at /usr/share/nginx/html,
    # but it should be served under /fe/ prefix
    alias /usr/share/nginx/html/;

    # Try static file or directory; otherwise serve the SPA
    # Use absolute fs path for alias fallback:
    try_files $uri $uri/ /usr/share/nginx/html/index.html;
  }
}